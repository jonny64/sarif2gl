{"version":"2.1.0","runs":[{"invocations":[{"executionSuccessful":true,"toolExecutionNotifications":[]}],"results":[{"codeFlows":[{"message":{"text":"Untrusted dataflow from /tmp/complex_flow.js:5 to /tmp/complex_flow.js:23"},"threadFlows":[{"locations":[{"location":{"message":{"text":"Source: 'rq.ids' @ '/tmp/complex_flow.js:5'"},"physicalLocation":{"artifactLocation":{"uri":"/tmp/complex_flow.js"},"region":{"endColumn":27,"endLine":5,"message":{"text":"Source: 'rq.ids' @ '/tmp/complex_flow.js:5'"},"snippet":{"text":"rq.ids"},"startColumn":21,"startLine":5}}},"nestingLevel":0},{"location":{"message":{"text":"Propagator : 'userInput' @ '/tmp/complex_flow.js:5'"},"physicalLocation":{"artifactLocation":{"uri":"/tmp/complex_flow.js"},"region":{"endColumn":18,"endLine":5,"message":{"text":"Propagator : 'userInput' @ '/tmp/complex_flow.js:5'"},"snippet":{"text":"userInput"},"startColumn":9,"startLine":5}}},"nestingLevel":0},{"location":{"message":{"text":"Propagator : 'step2' @ '/tmp/complex_flow.js:8'"},"physicalLocation":{"artifactLocation":{"uri":"/tmp/complex_flow.js"},"region":{"endColumn":14,"endLine":8,"message":{"text":"Propagator : 'step2' @ '/tmp/complex_flow.js:8'"},"snippet":{"text":"step2"},"startColumn":9,"startLine":8}}},"nestingLevel":0},{"location":{"message":{"text":"Propagator : 'step3' @ '/tmp/complex_flow.js:11'"},"physicalLocation":{"artifactLocation":{"uri":"/tmp/complex_flow.js"},"region":{"endColumn":14,"endLine":11,"message":{"text":"Propagator : 'step3' @ '/tmp/complex_flow.js:11'"},"snippet":{"text":"step3"},"startColumn":9,"startLine":11}}},"nestingLevel":0},{"location":{"message":{"text":"Propagator : 'step4' @ '/tmp/complex_flow.js:14'"},"physicalLocation":{"artifactLocation":{"uri":"/tmp/complex_flow.js"},"region":{"endColumn":14,"endLine":14,"message":{"text":"Propagator : 'step4' @ '/tmp/complex_flow.js:14'"},"snippet":{"text":"step4"},"startColumn":9,"startLine":14}}},"nestingLevel":0},{"location":{"message":{"text":"Propagator : 'step5' @ '/tmp/complex_flow.js:17'"},"physicalLocation":{"artifactLocation":{"uri":"/tmp/complex_flow.js"},"region":{"endColumn":14,"endLine":17,"message":{"text":"Propagator : 'step5' @ '/tmp/complex_flow.js:17'"},"snippet":{"text":"step5"},"startColumn":9,"startLine":17}}},"nestingLevel":0},{"location":{"message":{"text":"Propagator : '`' @ '/tmp/complex_flow.js:20'"},"physicalLocation":{"artifactLocation":{"uri":"/tmp/complex_flow.js"},"region":{"endColumn":18,"endLine":20,"message":{"text":"Propagator : '`' @ '/tmp/complex_flow.js:20'"},"snippet":{"text":"`"},"startColumn":17,"startLine":20}}},"nestingLevel":0},{"location":{"message":{"text":"Propagator : 'query' @ '/tmp/complex_flow.js:20'"},"physicalLocation":{"artifactLocation":{"uri":"/tmp/complex_flow.js"},"region":{"endColumn":14,"endLine":20,"message":{"text":"Propagator : 'query' @ '/tmp/complex_flow.js:20'"},"snippet":{"text":"query"},"startColumn":9,"startLine":20}}},"nestingLevel":0},{"location":{"message":{"text":"Sink: 'return db.select_all(query, [])' @ '/tmp/complex_flow.js:23'"},"physicalLocation":{"artifactLocation":{"uri":"/tmp/complex_flow.js"},"region":{"endColumn":31,"endLine":23,"message":{"text":"Sink: 'return db.select_all(query, [])' @ '/tmp/complex_flow.js:23'"},"snippet":{"text":"    return db.select_all(query, [])"},"startColumn":26,"startLine":23}}},"nestingLevel":1}]}]}],"fingerprints":{"matchBasedId/v1":"265ded951b3a15112dfe6d24f68c79a1fa64755886e235668bb31fac580ad2bb9cc3b5be5869db1c0d9d350f21a3cd612705cabcac3728d9c2643e4da827c2a8_0"},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"/tmp/complex_flow.js","uriBaseId":"%SRCROOT%"},"region":{"endColumn":31,"endLine":23,"snippet":{"text":"    return db.select_all(query, [])"},"startColumn":26,"startLine":23}}}],"message":{"text":"this.rq.ids injected in sql without sanitizing!"},"properties":{},"ruleId":"rules.select_hash"}],"tool":{"driver":{"name":"Semgrep OSS","rules":[{"defaultConfiguration":{"level":"error"},"fullDescription":{"text":"this.rq.$X injected in sql without sanitizing!"},"help":{"markdown":"this.rq.$X injected in sql without sanitizing!\n\n<b>References:</b>\n - [Semgrep Rule](https://gitlab.cheby.ru/sdl/semgrep/-/wikis/tests.semgrep.javascript.dia.rq.sql_injection.select_hash)\n - [https://owasp.org/Top10/A03_2021-Injection](https://owasp.org/Top10/A03_2021-Injection)\n","text":"this.rq.$X injected in sql without sanitizing!"},"helpUri":"https://gitlab.cheby.ru/sdl/semgrep/-/wikis/tests.semgrep.javascript.dia.rq.sql_injection.select_hash","id":"rules.select_hash","name":"rules.select_hash","properties":{"precision":"very-high","tags":["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')","MEDIUM CONFIDENCE","OWASP-A03:2021 â€“ Injection","security"]},"shortDescription":{"text":"Semgrep Finding: rules.select_hash"}}],"semanticVersion":"1.141.0"}}}],"$schema":"https://docs.oasis-open.org/sarif/sarif/v2.1.0/os/schemas/sarif-schema-2.1.0.json"}
